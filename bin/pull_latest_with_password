#! /bin/bash
# pull_latest_with_password
# Pull the latest course reserve data file from jenson, with password prompts
#
# Naomi Dushay 2012-03-14

REMOTE_DATA_DIR=/s/Dataload/SearchworksReserves/Data

#LOCAL_DATA_DIR=/data/sirsi/crez
LOCAL_DATA_DIR=../data

FULL_REMOTE_FILE_PATH="$(ssh apache@jenson ls -t $REMOTE_DATA_DIR/reserves-data.* | head -1)"
FILE="$(basename $FULL_REMOTE_FILE_PATH)"

if [ -r $LOCAL_DATA_DIR/$FILE ]; 
then
  echo "already have latest data: $FILE"
  exit 1
else
  scp -p apache@jenson:$FULL_REMOTE_FILE_PATH $LOCAL_DATA_DIR	
  exit 0
fi
